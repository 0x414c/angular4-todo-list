<div *ngIf="(todos | async)">
  <fieldset [disabled]="!((todos | async).length > 0)">
    <div class="row">
      <div class="col-md-12">
        <input [(ngModel)]="searchQuery"
               class="form-control"
               name="searchQuery" type="text" size="32" placeholder="Search tasks...">
      </div>
    </div>
  </fieldset>

  <div class="row">
    <div class="col-md-12">
      <h4>Tasks</h4>

      <p [ngSwitch]="(todos | async).length">
        <span *ngSwitchCase="0">No tasks added yet...</span>
        <!--TODO: [1;1] Get rid of case like `N of N remaining'-->
        <span *ngSwitchDefault>You have {{(remaining | async)}} tasks of {{(todos | async).length}} remaining</span>
      </p>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <div *ngIf="(todos | async).length > 0" [ngSwitch]="(todos | async | filter: searchQuery).length">
        <p *ngSwitchCase="0">(no search results for query "{{searchQuery}}")</p>

        <table *ngSwitchDefault
               class="table table-striped table-hover table-condensed">
          <tbody>
          <tr *ngFor="let todo of todos | async | filter: searchQuery"
              [ngClass]="{'success': todo.done, 'warning': shouldNotify(todo)}">
            <td>
              <input [(ngModel)]="todo.done"
                     type="checkbox">
              <span>{{todo.text}}</span>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-md-12">
      <button *ngIf="(todos | async).length - (remaining | async) > 0" (click)="onDone()"
              class="btn btn-success">
        Done <span class="badge">{{(todos | async).length - (remaining | async)}}</span>
      </button>
    </div>
  </div>
</div>
